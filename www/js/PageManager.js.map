{"version":3,"file":"PageManager.js","sourceRoot":"","sources":["../../scripts/PageManager.ts"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\n\nexport interface RenderPageResult { page: Element, component:Element }\n\nexport interface PageOptions { title:string, urlpath:string }\n\nexport class PageManager {\n    private pages:Array<Element> = new Array<Element>();\n    private currentPageIndex:number = -1;\n    private currentPage:Element = null;\n    private lastPageIndex:number = 0;\n\n    private _inTransition:boolean = false;\n    private _animationDelayMs = 300;\n\n    /** \n     * create a new page manager and call .activate() to hook events\n     */\n    constructor(activate:boolean = true, animationDelayMs:number = 300) {\n        if (activate)\n            this.activate();\n        this.setAnimationDelay(animationDelayMs);\n    }\n\n    /**\n     * activate enables this page manager's window event hooks. This overrides any previously set window.onpopstate\n     */\n    public activate() {\n        window.onpopstate = (ev:PopStateEvent) => {\n            //this.handleBackClick(ev);\n            if (!this._inTransition) {\n                ev.target.removeEventListener(\"click\", this.handleBackClick.bind(this));\n                document.removeEventListener(\"backbutton\", this.handleBackClick.bind(this), false);\n                this.popPage();\n                ev.preventDefault();\n            }\n        }\n    }\n\n    /** \n     * setAnimationDelay allows to override the default 300ms page transition speed\n     * Note: If overriding this, you should override your css animation speeds to the same value\n     */\n    public setAnimationDelay(delayms:number) {\n        this._animationDelayMs = delayms;\n    }\n \n    /**\n     * pushPage pushes in a new page to the navigation stack. \n     * (optional) animation can be slideIn, fadeIn\n     * (optional) page options can have a title and url to set when the page shows\n     */\n    public pushPage(page:Element, callback?:() => any, animation:string = \"slideIn\", options:PageOptions = {title:\"\", urlpath:\"\"}):boolean {\n        if (page==null || this._inTransition) return false;\n        if (options.title==\"\") options.title = Math.random().toString();\n        if (options.urlpath==\"\") options.urlpath = \"/\"+Math.random().toString();\n        \n        //find and hook back button if it exists\n        var back = page.querySelector(\"ons-back-button\");\n        if (back!=null) {\n            //TODO: handle back key press from android\n            back.addEventListener(\"click\", this.handleBackClick.bind(this));\n            document.addEventListener(\"backbutton\", this.handleBackClick.bind(this), false);\n        }\n\n        var anim:string = animation;\n        if (this.pages.length==0) \n            anim = \"\";\n\n        page.setAttribute(\"data-title\",options.title);\n        page.setAttribute(\"data-urlpath\", options.urlpath);\n\n        this.pages.push(page);\n        this.sendPageEvent(this.currentPage, \"hide\");\n        //this.sendPageEvent(page, \"init\"); //seems to be handled by onsen ui\n        this.setPageIndex(this.pages.length-1, anim, callback);\n        window.history.pushState({}, options.title, options.urlpath);\n\n        return true;\n    }\n\n    /**\n     * pushPageId pushes in a new page to the navigation stack if the dom id can be found\n     */\n    public pushPageId(pageContainerId:string, callback?:() => any, animation:string = \"slideIn\"):boolean {\n        var page:HTMLElement = document.getElementById(pageContainerId);\n        return this.pushPage(page, callback, animation);\n    }\n\n    /**\n     * countPages returns the number of pages in the stack\n     */\n    public countPages():number {\n        return this.pages.length;\n    }\n\n    /**\n     * popPage removes the current page from the navigation stack\n     * (optional) animation can be slideOut, fadeOut\n     */\n    public popPage(callback?:() => any, animation:string = \"slideOut\"):boolean {        \n        if (this.pages.length>0 && !this._inTransition) {\n            var page = this.pages.pop();\n            this.sendPageEvent(page, \"hide\");\n            this.sendPageEvent(page, \"destroy\");  \n            \n            if (this.pages.length==0) {\n                document.getElementById(\"app\").removeChild(page);\n                ReactDOM.unmountComponentAtNode(page);\n                if (callback)\n                    callback();\n            } else {\n                this.setPageIndex(this.pages.length-1, animation, callback);\n            }\n            \n            if (this.pages.length ==0 ) {\n                this.currentPageIndex=-1;\n                this.currentPage = null;\n            }\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * setPageIndex animates out the current page (if set) and shows the new page\n     * then sets up back button events, hides button if first page\n     */\n    private setPageIndex(index:number, anim:string, callback?:() => any) {\n        if (index>=0 && index<this.pages.length && this.currentPageIndex!=index) {\n            var sendShowEvent:boolean = false;\n            if (this.currentPage!=null) {\n                this.lastPageIndex = this.currentPageIndex;\n                this.currentPage.classList.remove(\"slideIn\");\n                this.currentPage.classList.remove(\"slideOut\");\n                this.currentPage.classList.remove(\"fadeIn\");\n                this.currentPage.classList.remove(\"fadeOut\");\n                \n                if (anim == \"slideOut\" || anim==\"fadeOut\") {\n                    sendShowEvent = true;\n                    this.currentPage.classList.add(anim);                    \n                    this.currentPage.classList.add(\"top\");   \n                                \n                    var outpg = this.currentPage;\n                    this._inTransition = true;\n                    setTimeout(() => {\n                        document.getElementById(\"app\").removeChild(outpg);\n                        ReactDOM.unmountComponentAtNode(outpg);\n                        this._inTransition = false;\n                        if (callback)\n                            callback();\n                    }, this._animationDelayMs);\n                } else if (anim == \"\" || anim == \"swap\") {\n                    document.getElementById(\"app\").removeChild(this.currentPage);\n                    if (anim!=\"swap\")\n                        ReactDOM.unmountComponentAtNode(this.currentPage);\n                }              \n            } else {\n                this.lastPageIndex = 0;\n                anim = \"first\";\n            }\n            \n            this.currentPageIndex = index;\n            this.currentPage = this.pages[this.currentPageIndex];\n            this.currentPage.classList.remove(\"slideIn\");\n            this.currentPage.classList.remove(\"slideOut\");\n            this.currentPage.classList.remove(\"fadeOut\");\n            this.currentPage.classList.remove(\"fadeIn\");\n            if (sendShowEvent)\n                this.sendPageEvent(this.currentPage, \"show\"); //seems to be kind of? handled by onsen ui for all but first page?\n\n            var back = this.currentPage.querySelector(\"ons-back-button\");\n            if (back!=null) {\n                if (this.currentPageIndex==0) \n                    back.className+=\" hidden\";\n            }\n\n            document.getElementById(\"app\").appendChild(this.currentPage);\n            document.title = this.currentPage.getAttribute(\"data-title\");\n\n            if (anim == \"slideIn\"||anim==\"fadeIn\") {\n                var outpg = this.pages[this.lastPageIndex];\n                this.currentPage.classList.add(anim);\n                this.currentPage.classList.add(\"top\");\n                this._inTransition = true;\n                setTimeout(() => {\n                    document.getElementById(\"app\").removeChild(outpg);\n                    //ReactDOM.unmountComponentAtNode(outpg);\n                    this.currentPage.classList.remove(\"top\");\n                    this._inTransition = false;\n                    if (callback)\n                            callback();\n                }, this._animationDelayMs);    \n            } else if (anim==\"\" && this.pages[this.lastPageIndex]!=this.currentPage) {\n                document.getElementById(\"app\").removeChild(this.pages[this.lastPageIndex]);\n                //ReactDOM.unmountComponentAtNode(this.pages[this.lastPageIndex]);\n                if (callback)\n                    callback();\n            } else {\n                if (callback)\n                    callback();\n            }            \n        }\n    }\n\n    /**\n     * renderPage renders the passed react element into a div container for use with \n     * pushPage, etc.\n     */\n    public renderPage(element:any, callback?: (element: Element) => any):RenderPageResult {\n        var p = document.createElement(\"div\");\n        p.classList.add(\"page-container\");\n        var c = ReactDOM.render(element, p, callback);\n        return {\"page\": p, \"component\": c};\n    }\n\n    private sendPageEvent(page:Element, eventname:string) {\n        var evt:Event = new Event(eventname);\n        if (page && page.childNodes && page.childNodes.item(0))\n            page.childNodes.item(0).dispatchEvent(evt);        \n    }\n\n    private handleBackClick(ev:Event) {\n        if (!this._inTransition) {      \n            window.history.back();\n        }\n    }\n}"]}